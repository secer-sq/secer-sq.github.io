<!DOCTYPE html>



  


<html class="theme-next pisces use-motion" lang="zh-Hans">
<head>
  <meta charset="UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=edge" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>
<meta name="theme-color" content="#222">









<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />
















  
  
  <link href="/lib/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css" />







<link href="/lib/font-awesome/css/font-awesome.min.css?v=4.6.2" rel="stylesheet" type="text/css" />

<link href="/css/main.css?v=5.1.4" rel="stylesheet" type="text/css" />


  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png?v=5.1.4">


  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png?v=5.1.4">


  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png?v=5.1.4">


  <link rel="mask-icon" href="/images/logo.svg?v=5.1.4" color="#222">





  <meta name="keywords" content="横贯八方," />




  


  <link rel="alternate" href="/atom.xml" title="故园遗剑" type="application/atom+xml" />






<meta name="description" content="本文有密码保护">
<meta property="og:type" content="article">
<meta property="og:title" content="XMind-XSS漏洞导致命令执行">
<meta property="og:url" content="http://yoursite.com/2021/05/13/XMind-XSS%E6%BC%8F%E6%B4%9E%E5%AF%BC%E8%87%B4%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C/index.html">
<meta property="og:site_name" content="故园遗剑">
<meta property="og:description" content="本文有密码保护">
<meta property="article:published_time" content="2021-05-13T15:37:11.000Z">
<meta property="article:modified_time" content="2021-05-13T15:55:56.391Z">
<meta property="article:author" content="mys3t">
<meta property="article:tag" content="横贯八方">
<meta name="twitter:card" content="summary">



<script type="text/javascript" id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/',
    scheme: 'Pisces',
    version: '5.1.4',
    sidebar: {"position":"left","display":"hide","offset":12,"b2t":false,"scrollpercent":false,"onmobile":false},
    fancybox: true,
    tabs: true,
    motion: {"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},
    duoshuo: {
      userId: '0',
      author: '博主'
    },
    algolia: {
      applicationID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    }
  };
</script>



  <link rel="canonical" href="http://yoursite.com/2021/05/13/XMind-XSS漏洞导致命令执行/"/>





  <title>XMind-XSS漏洞导致命令执行 | 故园遗剑</title>
  








<meta name="generator" content="Hexo 4.2.1"></head>

<body itemscope itemtype="http://schema.org/WebPage" lang="zh-Hans">

  
  
    
  

  <div class="container sidebar-position-left page-post-detail">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-wrapper">
  <div class="site-meta ">
    

    <div class="custom-logo-site-title">
      <a href="/"  class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">故园遗剑</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
      
        <p class="site-subtitle"></p>
      
  </div>

  <div class="site-nav-toggle">
    <button>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
    </button>
  </div>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu">
      
        
        <li class="menu-item menu-item-home">
          <a href="/%20" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-home"></i> <br />
            
            首页
          </a>
        </li>
      
        
        <li class="menu-item menu-item-about">
          <a href="/about%20" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-user"></i> <br />
            
            关于
          </a>
        </li>
      
        
        <li class="menu-item menu-item-tags">
          <a href="/tags%20" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-tags"></i> <br />
            
            标签
          </a>
        </li>
      
        
        <li class="menu-item menu-item-categories">
          <a href="/categories%20" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-th"></i> <br />
            
            分类
          </a>
        </li>
      

      
        <li class="menu-item menu-item-search">
          
            <a href="javascript:;" class="popup-trigger">
          
            
              <i class="menu-item-icon fa fa-search fa-fw"></i> <br />
            
            搜索
          </a>
        </li>
      
    </ul>
  

  
    <div class="site-search">
      
  <div class="popup search-popup local-search-popup">
  <div class="local-search-header clearfix">
    <span class="search-icon">
      <i class="fa fa-search"></i>
    </span>
    <span class="popup-btn-close">
      <i class="fa fa-times-circle"></i>
    </span>
    <div class="local-search-input-wrapper">
      <input autocomplete="off"
             placeholder="搜索..." spellcheck="false"
             type="text" id="local-search-input">
    </div>
  </div>
  <div id="local-search-result"></div>
</div>



    </div>
  
</nav>



 </div>
    </header>

    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div id="content" class="content">
            

  <div id="posts" class="posts-expand">
    

  

  
  
  

  <article class="post post-type-横贯八方" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2021/05/13/XMind-XSS%E6%BC%8F%E6%B4%9E%E5%AF%BC%E8%87%B4%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="mys3t">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="故园遗剑">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">XMind-XSS漏洞导致命令执行</h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2021-05-13T23:37:11+08:00">
                2021-05-13
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/%E6%A8%AA%E8%B4%AF%E5%85%AB%E6%96%B9/" itemprop="url" rel="index">
                    <span itemprop="name">横贯八方</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        <div id="hexo-blog-encrypt" data-wpm="Oh, this is an invalid password. Check and try again, please." data-whm="OOPS, these decrypted content may changed, but you can still have a look.">
  <div class="hbe-input-container">
  <input type="password" id="hbePass" placeholder="" />
    <label for="hbePass">此处输入密码</label>
    <div class="bottom-line"></div>
  </div>
  <script id="hbeData" type="hbeData" data-hmacdigest="bcec79e4be75e561dc9135a79388e53a3950e12865e6a696e5fedb4b8f1df910">9bedb90e105b2699093c03b9eca185eec3c40970e2d806f27b52e13ba77ecd5a2e96d5654aa80620c084e4668baf1ce683559bb42da33ba91685cb1d2b7bd9a35e5d506ff5e30bca826c75d293f53867d60b187fbeacd8b5e3b51ae9a0034d3275f8449295fbe839c3022c47444d32d34baa7d36aaff48766bed80745317cd3d08efa327a815f390148b7aa4ee3146990c17640ac9760b299104daea1dd924f144de4fbd038d93e3145ff95c911c0cfef0b264dfc58902340bc2fd0bb15ca0fa286f67110eb8a01e24aa269cbfb484fe056fc89f2546ef89718fcb82e95ce631e2e25db83e84e2d8469c5a6146a6a7f973b49bfba9241a8c5a00dfdd6b3cdd99ec6141f947da553f350b738d6e1bf274dc961d78f26d65862291a927c48211a2e5141333b10587e3b08963e4b418817373fa4dd0a0207630b4e08efc39d4cfd31637a44c23ae1a409dab6525b84b9cc59bf4804807ecdbedc7732a52050af7b7c54a286471964ddd746faf72f733a25cdffbbf162dcda344383be2076e6331d7c0c79b75f333324aad261a27d61749ebbfea7c700ad8d461f243bb065d7d035c8e3bccaee3631e00f14f2802b5b06a231b2c12631448abda3705f70448fbce627e787ece0fc712a78f3bc5a6ca99b5a83c4d7f8f9eb143323e566510d8d9b0c31933844f7991215944140f89d5bb7011f4c23aaff127a4680aa135eb4cf03c24758a6a85ad45cf4414e061aa53270a85e2f484551799dc7bdf509b8d4d262866c83141261d3ea2978ef81023cd890861960b34daef3eed6f6639943252ca9ccb27120f06515218ac8c6fbc316ff55caf2c8fca1565f078c29d71ee3eb66ec694c52ab1400d6d3ffb4d602ee2efb74dcbaff1a615dccf1dd060de45427234b2707c29d5d17c6a366bc7c73e2180fc26d819af7b51662238e3ba08400a20acb80ee0f5586c71d3073749ee3e90f1902badad8563348c7ef1d660ac37a291577ad6647cfe8da10886eaffd0b7e37793be503c6bd98e8f7fe3fc69cde5ae57ecfd7f5841b4e979429b56c4f891fe092fcebcdab71bc2bb410ebf739a7520fc0bd7f4dcbcab46ba6f02fd9163cf80a000b164f5f9b87a6d41c08b81b81e0d35d7ad95cb72f6b9253b6022a4692c1eae36616f2baff46125a99d0dab5c7e98add5c67a20783ffe08fa79b9a08691d1dfe4abb85f7ea29e7f88bc2e8041c26f7b2e56d30e0520360013e29b0a3040f443a9277e1926915f4c529f36bbfc32f383e5c49585280dc633eda017a9d49756882565814cfad0a67dda0ac607ff246a751b5e76579058cb6f65a38b68c1f9f60c0fc288c6f496770a92ee6f44469a2b1c1caaa442c4f20322b3d7eda4c877b32284cd403545364111949b038b22c05b0ae6cb7449bebaa4d80019e94893ce876c779cc187f74096b25ff953b207be41ad9302b7cf6a71978d3c2f4c3080c97afbd542b84690f7c03f1d246c95c8cef2e05f53ee4b6dc84b7b39e04557fad0c51ea21ed7402f4a8545ea3c9befa00517d5e2f644122bc23c0bfd0c979532c19acdf27d7cc6542e6fa10d4fa906bce5adff4e01e81590c7f5efa327f71bbf383680dd70262428cf4dafbcc025a98eb91272e934465135e85afe33b28b9e915ea4d16a4003eea301fd66d392a8f1ae8361fbe777ef275e5776b618839a93047628515a620a1230da13331db63bb45c741b475083b4dc153d3d095bc2207440793292b7f6d69b38fe9d0658bf0b9ff2757baeed90e76ca293407a4747e63b5462e8c40a9f96aae4cd52f0c7b05c40546f7a17ff18c9da3aec8ab80067563a6ebe551f0a77e77d714dc4b58238bda08e35512ab3cffbcd8acd852c2a99e80de0a250c6c5be1e6416a78eaa91172b8d3a12d144b83f7d73554e67142a5dbde55c3223bc9765fa1dacbad9a3fd9f0d8617fdbf84eda25a02099a22c6ccc62f9c982bc62c3ecbfcbddbe7d563105a889a0ea627dea5d74442d7fec7892b75ab33293f5262c78f8b9c2798e75e561fd5042e4bb3764452fa5859dcab8606d259914779ffbfcfccca8db96ca26c2f4024a2a2ebd02cdc774ceb4c31652cbe4c1093ffd95c03c5a3b123c0c98f4c76bef8201fdcfdc79d23bf45be8c8693f4f0aa43e7bc0fdbace1ece50c065b57e49a234009fb437d1dd46c9b983bbc6dc73ce31e48398a2764233af40a09c3d62cfacdbd85b20a16118111b7424d8d84615c691c5858d245df2f45ce265f6050cf7f342caa47984fb684b9a45534816d0f5cacf09c476a65b08fe9b7a53e47d7a275aea04cb95537edf5f56bb607df0367bd7f62c24ff34919abfc54786ec2ab8ad4bc94d553f43780b8e8a796452dd13845886b8898a8ff2c9bc53b1e3694f7a4020c43e6b7cda9d7d4593bcf0db005c23501bd15aeffb7346d9786543283a8f0ce5d1d25da352ada0abd1f91085e0ee84b0de0aba486355b075d06c075f439ddeb769da82568e248268206314b5443739359b01646050a5a1f307daa3c41fe20194e1356ae6db0224b70770eff8142516da479186a36a74cbb627733d5f3037ccd5445965d5f250f4b3a7395ede9fd4a925f46f5a645801e629f9d60614568ad57630aad4e00df337254dc8d9f760f4b7a9f0351efd347b244163ebf64cf8d178afdeae1d601868f90f2bec71c5e009507004878e05a5bdd18fb851305979a402b2f020d1a722e1f87fc7ab9b8b9f767310184a553cc7cb33baea6073ed904d80a54034e5e023b6e63c31490a1b21649f8cda924d277e4e81a1c092b4aa329652762b0df98b9ad19f1ec6829f34b97ba94723efe491e3d428473e1a1e05559700b3866d7cc1d50b199865488fd9fd57525d0e015e06543f26b774b6acab69d8870bf4c1a00a6c28361f0ea8defef4eef82a5f2f7d5bb27d672afa82b473020b0b78bedf9d5d32096cefb50c519a4f220fb5dd1e425a8218c9c91ee808b45789c1b612263d252417c61813ac80df707b4d94018b285113751eb54ab74ebdeefaa487e05b045cf257acff106be381432e8c490a355d1d3a39a4aa64da0c8249cf7935eb474e2d25318399af9e8645a832a1aae2773d5a1cd088f96485057eccad0e6661420996efb263a4daea19a086b219d9f24cc676ae66986cbdf959bcce8c300d418b1837f0f18cf40d37eba8cbedd85567c1ca228ceb67b23ce36459e24e61ad686236fbc601afea53d0eede5885e850ede3a108c692711efc0baba4d4f24e5d668ebfd086a4b0bd7e493089ff1b65013cfa17317e88c194bea4115c515459e1dec6cef895f7e9d956191fc9eb4ba48d1bf10b9096136953fab12170a98ed980dca20c29f145031a5dd0ba80fb166f7c836aed7fe8153754b72e0336eb9b8c0fa7884c0c7b95e31f4afe3f3bc332232db0689b02575660ca838beb8654212da0c7065606ca71422fa3454ee14f0ddf1260a8fcba51c4b654a2a6ebd8c96dd855de9c0504e27d7a0d302d5ac4a4258c8fa112aacbabe74c7d7c456ccf210d110f8a2bbfa3d83a0017c450cb8509869bbb59e94e1b9454960697fd4c7afdfa042b2ad943c43077c1e11aa92b5eef0303f94369c6048c6ec944e62599910d9d2252c76c5d974798b1d0ee53d4abb345b58f83d6c4e8d3e3fec99d3922f94e4c95254d1b67ff691a338bc2eb37cef0506a5f8dfe533cf1d7089b3df6b780c37a9a889da1d2c985272d3ef692f7a760c54f0f7ef503f7af1198aa6076d8c3e0c2291981c295abacd1ff176a1cc8a815cff0292438e93779de779cc3ced101e8cda783bbe9a08bd93658f3d9cb2722a5d19fff2a5e5602f052fa52d21997a43c559af331219a4b6e70747789ff9e087acf4c2e3cd69ef4e634db50ecf1c0e36e20b547bb5b5af2474ea77548bb015926ba287c23d5b5aa5530d0c4c12e3d0cd1d72d583c10cd990e248fcf3ad151611c8d621a2bdc7a0a58f16d9fc78ad0591e5b8ba1dffe3d64d6e93e14483b41dd2c6002c98112b83b2ec82a5d757d5765a25949726e8158b3536f2fe3f8834d8b2de7023945a006ac454e2e6c9681c4c31db87f2c792365022dcb70de322d36c0165aec43f519023bf2ac18e17d80b5f9118452d7180a8a5ce010904a09f93d0b7828373322ddc28ca8299d25afdc00c021cd24684eadb5820248ba4cf620659a0b3915eace1ef01671e8d8327d7bfb293a4b403c2664866c10e201cc418f0f55a331c623c1e44c7a0ecfb3c0d4e2cd9e7127c61da2b8fb9f7a473e7d73391b9cd0649410f9a262b7c6f3938877dbbf3a0c5c9a74bc36a050283854ce65398b7bccc73c01957ca13dacfb3dc92a7eceb14e7b95b57f0c50c2ec69145093db9bbffffc0c8422c04523a656690c7b2ad20b3038ebe789a317aebcf9d7455caaca06b84fe9e0ffcf4d413d80ea61d667c11ee77566fde57ea6e048c756379d510869ffc14ce25ea66cacfdd5c05c40c07da6d95f6f1efb4879631ee6e3fab5e240704057389d137ba76543b544cd58fb0f4b3aff13254cbf7fbb431976f29620a52f88caf90972e2b76f9480691f0d5f900a9981b18dbcca3698d4218acf8e280a4b4908978483a2ff76698c34207f00d59dc2c91e3363fb564dc2184a9c2f1ebce53e089d8f114b1fff1e25470280812cf722a3373770b5a4038b44a38d959e356c407a03a960d169e921fcf5d06ffd7b2dfd17677b6aeeca3132d005d181af3356a3441517ad9b0902cf6dce6b0c996796cb6ff5880d29591d58112890809c69d587b60f681124d413f02c4109d68b40af6540147ec07826d859cf4d6522ca5372897797109e0c83bf507ddc13b2d3939dbbcb6df3b44641c2b137d5954f29989ef17f6f299e72ecc7cbe39e93530e867607e34ba4f525a2be27e188fca2224e22e8058e2517d8cb119cfaf9dac5b047559b6c39a75734fdd19c6d93f02b32561ceb08d24f752befc4f30b5dc6b4855c1606817dfb354667e3ecc36573653933e2096b265b299daa18fc8f37ba9a8976f731cca6c677ce08771e86e2bb42f8214bf1082f8a3ffd4eaac0edbdca32f8d6fc8d9e15653c56e4c68d29f1b723dd6fa39a432a457043e623a103db7d3b95a7caa7e228bf37a6a8c1433e3b0da221f108e96ffbd04042d73174e880f2385c4d80311a3450d555836ba2a8495d81818d197e604424ffd89cbbce6795a97b6eb67b6652ff9c8d800712140dca1d5680961da5ff82973c3b3cb99cf93f83f1860e3bc7a8a0dc28583b436f65a0781c187a2fde00e6521886266c2a28ab421f3f1ff65791704acf3ca9430cac08415dd9b51011d825799b66028dda686189ab72eba927688b110d51e3b746e080bc72e65cbdd8a5de0a4e7e8a8a24ba84a2073b9e0d9fce33d5691de6470af8993153c0301044a3b47f0a659c78e6732ddbf25f051e65c8b7ea41f34979f51b60dc10ed2a8ac859018e3427e8bbb551288f005a7c30b208c615240d032d82e8c3f073b479788d8c14a85d4415931b53dc33c163a8f486d791d5446979462bb33d221fed4de5161503fbdb733b263289727bcfe3e637e0e4476e2668132711723008fb6a362048c7536fee8567e3ecd4761b6ad79336b495ee86463af00ab0618d74a69c195c0991447eb90080739589fc0ba4e2cd64dba04da1fcaefe16fc167063e81557fe55480fdd13772332b53a203677709f2a83366d7642f613ca0f222809705998f580b9c6dd2324f4a1c0501897293d4a65bb268651cbb12f7d3fcc979d8c99520783d2eb6b59a60cf67add33847ad807c052b9bc0cbe4efcc3114e360546dbe9d0497d3f186deffddf2bd57c150e07f5bc03f25e2e80e6b9bf614e87f932ccab5103099212d8acc28336c8616065ab46b6540254d7124a2cff7f28bc93ce978ec9c61a0d7d8f442a535a6db4c2a10ce75374de2aa19c4d69a012147ed5289ea791c41c1da5931ef8af2bc41865380601d6ee9ae14b84603d23d706cd58ad1dc1935c34beba2f3dae74a1078532d5c70e80c640336e373bcde59532d350b2117713e599a55c5296f8a7540e44e67603e6b75532dc685cad7c44182f400f01ed43442e0b646b771ee35aa237ebe0a600fcb763e3b1f4378294951e8507ea32dc50d60fb3b8ca7d5a7cf0d13473a77648278cbf63d980c7d25e03932d230bbf5878c24448f1d650c630e5e5f5294f33b55237932c6a19b8fa77be06260c9a7ef264e331b838ee19de1ea8dc97255764770d3ea0d003eaf49747863bb569d1dc4d627afc8af18ec99a82768e11790cb923f8a071fa99cd3b1a38330fb6cf2a5e98e4244514f7d03f78f71d0f6d1fdac86f23198b3f9920b4ffad784a4b4f731ee982537e071dea2c2f28a3a68420a0a5667b892ab42be0d7a94c7c248a55b0994198455d4b4e4621f5bb5b6fd054f995b2848ae653b0ef7a93e122c7f9f2bea8af42b94dab65541eb5536faba80a366475a4b1ac074775431254fc78e170ace8c3905b5ba458b15b4b2af226d9186286fa3d15a54278021646f13b355e1f200e7eacd30cf2ad6e8ab37a9a403ccaf8bc421a81fa1624735e63a9ef1521b0d7196b0d610c207d642961a43795fc0b41eef9f4ce848381d04416f4c01a6620f92405d0877e1c4807b81754a1335aed4d874499eb2b3459cd0d585d4599f80ae41f1ae75160d40a4baa671394d1302d8113ebf02693724bc24a8feac2e3598b69ada5e28d940e81aaea7810a940b3ae736cfd3c5dd1ca4b5314e31ae8ee0d2d55837b22a2cb512e9820c1dedd5b407933d8bbb905eebed4608adc2ab900b5f49d9d96ca16bd0bd45bdd85f7e68258158f695853d4a3d70aa034b064e189ed1a60708bf7f0c622e5e8f05cb89397a3b2f8aad4ab77e65471cda200974acdd3bd00bca23db1b6d462273d79566a0dd2c679c01b0edc5b839c8362f0d4cd4eb983e6a555846e31f94f4ac21f23b7f895a3f26e03458e015cf3ce6b0f2234786e0dde2ce45ea0b6a3f7fa370db30f09b3cb2f5840e7acce4520defa2fe978b38e06070e8d868bb099c4852e7eb97211079c3df08465fa229b2b9397caa413b4f5f141646ab45ae204532c4c7d22087b102340d708e40c54c5b2a03024256101376094f7787c3dfbd6f6bf551f43b12cd67c57bd9028c57ef8d76866b9a36f0b4b366ca2a1da515f3df822a51a1c51e48967bdbbeb55b2ec4699b8b41abdc4a9c75a79e3f3501339503a7d07b5e3c04bc74eee68fd0b45c6db391efb8fa0a2a359e2e1c68b7920d9bc07849a92733191b9edc7fe28db8c43a9315872f45f83f06a6b546caed5de3d833b47f0ba437e054d3dfc7a828922b51c8bc123322116c6915534bbc0000521fa2f1b27cb12946b9ff23a2ca5ebe0c24447c1c2ca70fa01036a38f86627b804a956067a3a07b73c2ae323a94d314b33d90d08db2bdd7baec1789b7c598f680bd0fdad8b0d1b4aa6b42c25e3738e3ad270e9a06c329fde427e5d2ded0722685256ed716cdfd226c0b9c8ff1334284d4b83c354f42d4049ff9158433d64244e93799818bdb79c32da6af82f9a22933eade60935521a84882f1dfef86f653ed01d09468ed6a7f0b6faa3685cdc27754b9d629e964ee24862332b85ef156d7e42013af464df8f032da901fd04f0541c7c854a088df4d130b2eb91cf2c38ba0eae71086a26bbfe707407152e23eababe9152f45e47be4cc544827225102ead96146f06b37a611df5f1eb1adb4900b52bd04f13585fb3769880a99b6bb83a30559f2b9653bf2abfbe96129ffe646d179be75102aa490088557875e2b7dce7fd1612fceb6b40fb2a5eebe25e5e2b9f2ccd3d80c39eee6034837cfb312071dace70ae7f2ce05a1fdf7a03713c38f1510da86e3a49c8efde685a6db0f4ce5e68658d6314803e35bc55909c87fe83f6de78d997481ab98e14a7fa72926c9ab679c691ebba65f6e2d171a17cef7d964a2ef7ecb81b9955cd86eff0dc367782a578e59cc9890aa09d1487bfbeb4990fa222e0c831d2924d95bbb390f49ebc967147c0fdbf56733652182a4c96e2d245a39c119eafee007f034088a0c06001858d566c7911242cb308de8e2f38c24cfd826e0eed70a56dd2dd83f27005e28bb507cd0e4b8b45b433f5aaee2f5822af62ddf356d51ce02e73556292303a12d2bba62aca09543825422bcd895b06d49f43b984125452cf2f290a5d8b3ddc2cdd7d17bfa63eec19ce77af9b47efa06c8ea26b251dedd9455192a2fcd1f0ba20bad3b2fe387b14a64f93626331783b5cacdf8efbdf6d2f31bf29d080610ef7c458bd60239a69b01443e6a45f912a5cf779e07f654557c9186eea8a6dae561e616abf40f28109d8bd054d0985cb6c10c569f003db9db3864f4f0fb1aa466e672b1c78d138efd7eeb4d03b1768363c8aa16d4ece59a6c26c94df97baee78fd635af911bf74f0fcc2d4d28297fa86e0a4d87882b4447ba0975277e6e0f0eb04ff9cb818447177b509266f176c2038a0b9b8f50fd7758d0a146e19df8fb1b07a4d08c991957e0c5323835d3f6eda63d214f2419edae05af3f266f8f555e74ddf3affe2fb54e87dbf7cbd8862044ae2cf4f58d75bcef27f114d68cdfbf510ee97d9b37d15b588ec7aee041fdca01dbcc337ee739a6994f292ad74a8a3d85d2612bc376dd95ebc311aa109bcccf32d5a51d75b926abffce4d0c62bbf7e8c98e960699d092d16a7d0c8b96ada86e567b70e18cfa8aded32e6513077b3090bcdda43793c91f95d9a3e39033fd7cdf1995203a0602e08ab75e441618fa3aa78c01fae6e6da7b7ca35593b9d47497b478d31192c03b2c1fe79e4044856b904aff2d4a371726683d564af2d1e4362d1d02d03946e599a61d469f469a425e3d22665a345afd7b5e372ebdbc2e040edf466c261633dc714ab3c888cfdd32063afd5ad2cf822ed1bb649d78e52f7dd9f248a77c84684d0196ff3d69300efad09f477db1a94c544248f29094b5386227c3fdccdba8f76f2d90e9de5c2582fa51146b79c1ac92dd01327531890e751c6240be061dfb3645bc6ad6b3544547f70edd99feefbee56471dcf17d65580c11f1a7672a5a48f10f4e31f9ea222a378a39b1583fcf056d9285d41256591328c615c6a548432d4705daf4851420b265ff61944f5f98554ea21d069a3d4280443553cb16bd26eff697bfde3f7c43f84c97d3859d81f7b212de7af1d373b56e40da5fa934bdf9e4647dcd05e1ae75827f64d354b0dbdccd6d7be3e7c7a43a178dd22e93c4f05a2bcd18c78acbe6a0396b1bb37ef38df2c9852104cefafc51ceafae7926036fff7e3b3139e0cb117361c6bc2ff213b45acd487267adcf1fe4efdd4180ab3a6a82c1e27506d8e47ee9c6cbd2d8f60de96ccc8393ec0aba10beafae1b2352d87390852b869c0a7afd9baa333167ab33e41bcc312ee74b50670e34933146c56943f47c86427eb515dc2d99f3ff0d10c4ea9be9634a0d49272a5941f1e9574c9919e6cf585baeb47576194c4d45c22a3544ae7ef3d724bcea58e9039e327a1c47d5c39064eed4cbb65758228202f8a3fee147513f5d58e022b1f96a2e1fd81973059819de358ce64ef40caf044019fa99230e80d0c5a1a54525aa257b33cac2edb8de8f458bb955fd34ab531064c7a32dc66debe6322b988e7fdea70b714082437ec149b92da136c8a6298ab9b4fc6ec369c9ddc8d12595ea018d1d5c78576dfaa28cc3a7cf96f8efe05059b24c79ca24e48a7dce38435ba8b5d1c8f2fe73c81f70262032b9fe0348b5e5e97d6b9b159a004149a8c8bdb51dbe71f6e0bbd9b4c75b5564dc9ebade409d0cc51ed30be156a0c327091a6006b19901e87800047dd14fdd6551f8fecf9ca6e197f9c042e27302df7e00b36bd819353b517797c80c3e4d49b86e92218396a34c640dd7c1f427c4f07265096ea093bbf46a475e83a5accf65377752b44f177c675c357286f92f44109cf003a70a58e139b23f597835ca41f6dcba6487f52a2d5780acfff91aa0f5a9971196923882d906ebcf84915b986bbd5cc657e8cfe0493f353e09b2cf01c3191a39f5160b55a72b7f84aab906b0f74d95cdf14616c1b17e62bca92aa46861c42b4253aea1acabbf74f35c0e6fe5fc4d5ed02dd30c0cf3</script>
</div>
<script src="/lib/blog-encrypt.js"></script><link href="/css/blog-encrypt.css" rel="stylesheet" type="text/css">
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      
        <div class="post-tags">
          
            <a href="/tags/%E6%A8%AA%E8%B4%AF%E5%85%AB%E6%96%B9/" rel="tag"># 横贯八方</a>
          
        </div>
      

      
      
      

      
        <div class="post-nav">
          <div class="post-nav-next post-nav-item">
            
              <a href="/2021/04/01/%E8%AF%86%E5%88%ABCobaltStrike%E5%88%B0JA3/" rel="next" title="识别CobaltStrike到JA3">
                <i class="fa fa-chevron-left"></i> 识别CobaltStrike到JA3
              </a>
            
          </div>

          <span class="post-nav-divider"></span>

          <div class="post-nav-prev post-nav-item">
            
              <a href="/2021/05/14/%E7%BD%91%E5%AE%89%E9%9D%A2%E8%AF%95%E5%BF%85%E8%80%83%E9%A2%98%E5%90%88%E9%9B%86/" rel="prev" title="网安面试必考题合集">
                网安面试必考题合集 <i class="fa fa-chevron-right"></i>
              </a>
            
          </div>
        </div>
      

      
      
    </footer>
  </div>
  
  
  
  </article>



    <div class="post-spread">
      
    </div>
  </div>


          </div>
          


          

  



        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    
    <div class="sidebar-inner">

      

      

      <section class="site-overview-wrap sidebar-panel sidebar-panel-active">
        <div class="site-overview">
          <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
            
              <p class="site-author-name" itemprop="name">mys3t</p>
              <p class="site-description motion-element" itemprop="description"></p>
          </div>

          <nav class="site-state motion-element">

            
              <div class="site-state-item site-state-posts">
              
                <a href="/archives">
              
                  <span class="site-state-item-count">76</span>
                  <span class="site-state-item-name">日志</span>
                </a>
              </div>
            

            
              
              
              <div class="site-state-item site-state-categories">
                <a href="/categories/index.html">
                  <span class="site-state-item-count">19</span>
                  <span class="site-state-item-name">分类</span>
                </a>
              </div>
            

            
              
              
              <div class="site-state-item site-state-tags">
                <a href="/tags/index.html">
                  <span class="site-state-item-count">29</span>
                  <span class="site-state-item-name">标签</span>
                </a>
              </div>
            

          </nav>

          
            <div class="feed-link motion-element">
              <a href="/atom.xml" rel="alternate">
                <i class="fa fa-rss"></i>
                RSS
              </a>
            </div>
          

          

          
          

          
          

          

        </div>
      </section>

      

      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright">&copy; <span itemprop="copyrightYear">2021</span>
  <span class="with-love">
    <i class="fa fa-user"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">mys3t</span>

  
</div>


  <div class="powered-by">由 <a class="theme-link" target="_blank" href="https://hexo.io">Hexo</a> 强力驱动</div>



  <span class="post-meta-divider">|</span>



  <div class="theme-info">主题 &mdash; <a class="theme-link" target="_blank" href="https://github.com/iissnan/hexo-theme-next">NexT.Pisces</a> v5.1.4</div>




        







        
      </div>
    </footer>

    
      <div class="back-to-top">
        <i class="fa fa-arrow-up"></i>
        
      </div>
    

    

  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>









  












  
  
    <script type="text/javascript" src="/lib/jquery/index.js?v=2.1.3"></script>
  

  
  
    <script type="text/javascript" src="/lib/fastclick/lib/fastclick.min.js?v=1.0.6"></script>
  

  
  
    <script type="text/javascript" src="/lib/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/lib/fancybox/source/jquery.fancybox.pack.js?v=2.1.5"></script>
  


  


  <script type="text/javascript" src="/js/src/utils.js?v=5.1.4"></script>

  <script type="text/javascript" src="/js/src/motion.js?v=5.1.4"></script>



  
  


  <script type="text/javascript" src="/js/src/affix.js?v=5.1.4"></script>

  <script type="text/javascript" src="/js/src/schemes/pisces.js?v=5.1.4"></script>



  
  <script type="text/javascript" src="/js/src/scrollspy.js?v=5.1.4"></script>
<script type="text/javascript" src="/js/src/post-details.js?v=5.1.4"></script>



  


  <script type="text/javascript" src="/js/src/bootstrap.js?v=5.1.4"></script>



  


  




	





  





  












  

  <script type="text/javascript">
    // Popup Window;
    var isfetched = false;
    var isXml = true;
    // Search DB path;
    var search_path = "search.xml";
    if (search_path.length === 0) {
      search_path = "search.xml";
    } else if (/json$/i.test(search_path)) {
      isXml = false;
    }
    var path = "/" + search_path;
    // monitor main search box;

    var onPopupClose = function (e) {
      $('.popup').hide();
      $('#local-search-input').val('');
      $('.search-result-list').remove();
      $('#no-result').remove();
      $(".local-search-pop-overlay").remove();
      $('body').css('overflow', '');
    }

    function proceedsearch() {
      $("body")
        .append('<div class="search-popup-overlay local-search-pop-overlay"></div>')
        .css('overflow', 'hidden');
      $('.search-popup-overlay').click(onPopupClose);
      $('.popup').toggle();
      var $localSearchInput = $('#local-search-input');
      $localSearchInput.attr("autocapitalize", "none");
      $localSearchInput.attr("autocorrect", "off");
      $localSearchInput.focus();
    }

    // search function;
    var searchFunc = function(path, search_id, content_id) {
      'use strict';

      // start loading animation
      $("body")
        .append('<div class="search-popup-overlay local-search-pop-overlay">' +
          '<div id="search-loading-icon">' +
          '<i class="fa fa-spinner fa-pulse fa-5x fa-fw"></i>' +
          '</div>' +
          '</div>')
        .css('overflow', 'hidden');
      $("#search-loading-icon").css('margin', '20% auto 0 auto').css('text-align', 'center');

      $.ajax({
        url: path,
        dataType: isXml ? "xml" : "json",
        async: true,
        success: function(res) {
          // get the contents from search data
          isfetched = true;
          $('.popup').detach().appendTo('.header-inner');
          var datas = isXml ? $("entry", res).map(function() {
            return {
              title: $("title", this).text(),
              content: $("content",this).text(),
              url: $("url" , this).text()
            };
          }).get() : res;
          var input = document.getElementById(search_id);
          var resultContent = document.getElementById(content_id);
          var inputEventFunction = function() {
            var searchText = input.value.trim().toLowerCase();
            var keywords = searchText.split(/[\s\-]+/);
            if (keywords.length > 1) {
              keywords.push(searchText);
            }
            var resultItems = [];
            if (searchText.length > 0) {
              // perform local searching
              datas.forEach(function(data) {
                var isMatch = false;
                var hitCount = 0;
                var searchTextCount = 0;
                var title = data.title.trim();
                var titleInLowerCase = title.toLowerCase();
                var content = data.content.trim().replace(/<[^>]+>/g,"");
                var contentInLowerCase = content.toLowerCase();
                var articleUrl = decodeURIComponent(data.url);
                var indexOfTitle = [];
                var indexOfContent = [];
                // only match articles with not empty titles
                if(title != '') {
                  keywords.forEach(function(keyword) {
                    function getIndexByWord(word, text, caseSensitive) {
                      var wordLen = word.length;
                      if (wordLen === 0) {
                        return [];
                      }
                      var startPosition = 0, position = [], index = [];
                      if (!caseSensitive) {
                        text = text.toLowerCase();
                        word = word.toLowerCase();
                      }
                      while ((position = text.indexOf(word, startPosition)) > -1) {
                        index.push({position: position, word: word});
                        startPosition = position + wordLen;
                      }
                      return index;
                    }

                    indexOfTitle = indexOfTitle.concat(getIndexByWord(keyword, titleInLowerCase, false));
                    indexOfContent = indexOfContent.concat(getIndexByWord(keyword, contentInLowerCase, false));
                  });
                  if (indexOfTitle.length > 0 || indexOfContent.length > 0) {
                    isMatch = true;
                    hitCount = indexOfTitle.length + indexOfContent.length;
                  }
                }

                // show search results

                if (isMatch) {
                  // sort index by position of keyword

                  [indexOfTitle, indexOfContent].forEach(function (index) {
                    index.sort(function (itemLeft, itemRight) {
                      if (itemRight.position !== itemLeft.position) {
                        return itemRight.position - itemLeft.position;
                      } else {
                        return itemLeft.word.length - itemRight.word.length;
                      }
                    });
                  });

                  // merge hits into slices

                  function mergeIntoSlice(text, start, end, index) {
                    var item = index[index.length - 1];
                    var position = item.position;
                    var word = item.word;
                    var hits = [];
                    var searchTextCountInSlice = 0;
                    while (position + word.length <= end && index.length != 0) {
                      if (word === searchText) {
                        searchTextCountInSlice++;
                      }
                      hits.push({position: position, length: word.length});
                      var wordEnd = position + word.length;

                      // move to next position of hit

                      index.pop();
                      while (index.length != 0) {
                        item = index[index.length - 1];
                        position = item.position;
                        word = item.word;
                        if (wordEnd > position) {
                          index.pop();
                        } else {
                          break;
                        }
                      }
                    }
                    searchTextCount += searchTextCountInSlice;
                    return {
                      hits: hits,
                      start: start,
                      end: end,
                      searchTextCount: searchTextCountInSlice
                    };
                  }

                  var slicesOfTitle = [];
                  if (indexOfTitle.length != 0) {
                    slicesOfTitle.push(mergeIntoSlice(title, 0, title.length, indexOfTitle));
                  }

                  var slicesOfContent = [];
                  while (indexOfContent.length != 0) {
                    var item = indexOfContent[indexOfContent.length - 1];
                    var position = item.position;
                    var word = item.word;
                    // cut out 100 characters
                    var start = position - 20;
                    var end = position + 80;
                    if(start < 0){
                      start = 0;
                    }
                    if (end < position + word.length) {
                      end = position + word.length;
                    }
                    if(end > content.length){
                      end = content.length;
                    }
                    slicesOfContent.push(mergeIntoSlice(content, start, end, indexOfContent));
                  }

                  // sort slices in content by search text's count and hits' count

                  slicesOfContent.sort(function (sliceLeft, sliceRight) {
                    if (sliceLeft.searchTextCount !== sliceRight.searchTextCount) {
                      return sliceRight.searchTextCount - sliceLeft.searchTextCount;
                    } else if (sliceLeft.hits.length !== sliceRight.hits.length) {
                      return sliceRight.hits.length - sliceLeft.hits.length;
                    } else {
                      return sliceLeft.start - sliceRight.start;
                    }
                  });

                  // select top N slices in content

                  var upperBound = parseInt('1');
                  if (upperBound >= 0) {
                    slicesOfContent = slicesOfContent.slice(0, upperBound);
                  }

                  // highlight title and content

                  function highlightKeyword(text, slice) {
                    var result = '';
                    var prevEnd = slice.start;
                    slice.hits.forEach(function (hit) {
                      result += text.substring(prevEnd, hit.position);
                      var end = hit.position + hit.length;
                      result += '<b class="search-keyword">' + text.substring(hit.position, end) + '</b>';
                      prevEnd = end;
                    });
                    result += text.substring(prevEnd, slice.end);
                    return result;
                  }

                  var resultItem = '';

                  if (slicesOfTitle.length != 0) {
                    resultItem += "<li><a href='" + articleUrl + "' class='search-result-title'>" + highlightKeyword(title, slicesOfTitle[0]) + "</a>";
                  } else {
                    resultItem += "<li><a href='" + articleUrl + "' class='search-result-title'>" + title + "</a>";
                  }

                  slicesOfContent.forEach(function (slice) {
                    resultItem += "<a href='" + articleUrl + "'>" +
                      "<p class=\"search-result\">" + highlightKeyword(content, slice) +
                      "...</p>" + "</a>";
                  });

                  resultItem += "</li>";
                  resultItems.push({
                    item: resultItem,
                    searchTextCount: searchTextCount,
                    hitCount: hitCount,
                    id: resultItems.length
                  });
                }
              })
            };
            if (keywords.length === 1 && keywords[0] === "") {
              resultContent.innerHTML = '<div id="no-result"><i class="fa fa-search fa-5x" /></div>'
            } else if (resultItems.length === 0) {
              resultContent.innerHTML = '<div id="no-result"><i class="fa fa-frown-o fa-5x" /></div>'
            } else {
              resultItems.sort(function (resultLeft, resultRight) {
                if (resultLeft.searchTextCount !== resultRight.searchTextCount) {
                  return resultRight.searchTextCount - resultLeft.searchTextCount;
                } else if (resultLeft.hitCount !== resultRight.hitCount) {
                  return resultRight.hitCount - resultLeft.hitCount;
                } else {
                  return resultRight.id - resultLeft.id;
                }
              });
              var searchResultList = '<ul class=\"search-result-list\">';
              resultItems.forEach(function (result) {
                searchResultList += result.item;
              })
              searchResultList += "</ul>";
              resultContent.innerHTML = searchResultList;
            }
          }

          if ('auto' === 'auto') {
            input.addEventListener('input', inputEventFunction);
          } else {
            $('.search-icon').click(inputEventFunction);
            input.addEventListener('keypress', function (event) {
              if (event.keyCode === 13) {
                inputEventFunction();
              }
            });
          }

          // remove loading animation
          $(".local-search-pop-overlay").remove();
          $('body').css('overflow', '');

          proceedsearch();
        }
      });
    }

    // handle and trigger popup window;
    $('.popup-trigger').click(function(e) {
      e.stopPropagation();
      if (isfetched === false) {
        searchFunc(path, 'local-search-input', 'local-search-result');
      } else {
        proceedsearch();
      };
    });

    $('.popup-btn-close').click(onPopupClose);
    $('.popup').click(function(e){
      e.stopPropagation();
    });
    $(document).on('keyup', function (event) {
      var shouldDismissSearchPopup = event.which === 27 &&
        $('.search-popup').is(':visible');
      if (shouldDismissSearchPopup) {
        onPopupClose();
      }
    });
  </script>





  

  

  

  
  

  

  

  

</body>
</html>
